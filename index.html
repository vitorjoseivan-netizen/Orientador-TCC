                <!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orientador TCC Digital - Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary: #003366;
      --secondary: #f4f7f9;
      --accent: #ffcc00;
      --success: #28a745;
      --text: #333;
      --white: #ffffff;
      --info: #03a9f4;
      --warn: #b45309;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--secondary);
      color: var(--text);
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* SIDEBAR */
    .sidebar {
      width: 280px;
      background: var(--primary);
      color: var(--white);
      padding: 20px;
      display: flex;
      flex-direction: column;
      box-shadow: 4px 0 10px rgba(0,0,0,0.1);
    }

    .sidebar h2 {
      font-size: 1.2rem;
      margin-bottom: 30px;
      text-align: center;
      color: var(--accent);
    }

    .menu-item {
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      display: flex;
      align-items: center;
      background: rgba(255,255,255,0.05);
      user-select: none;
    }

    .menu-item:hover { background: rgba(255,255,255,0.15); }
    .menu-item.active { background: var(--accent); color: var(--primary); font-weight: 700; }

    /* MAIN CONTENT */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    header {
      background: var(--white);
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ddd;
      gap: 20px;
      flex-wrap: wrap;
    }

    header h1 { font-size: 1.4rem; }
    header p { margin-top: 6px; color: #555; }

    .thermometer-container { width: 320px; }
    .label-progress { font-size: 0.85rem; margin-bottom: 6px; display: block; }
    .progress-bg { background: #eee; border-radius: 10px; height: 10px; width: 100%; overflow: hidden; }
    .progress-fill {
      background: linear-gradient(90deg, var(--accent), var(--success));
      height: 100%;
      width: 0%;
      border-radius: 10px;
      transition: width 0.4s ease;
    }

    /* CHAT AREA */
    .chat-area {
      padding: 40px;
      max-width: 900px;
      margin: 0 auto;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .bubble {
      max-width: 80%;
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 10px;
      line-height: 1.6;
      position: relative;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    }

    .bubble-ai { background: var(--white); border-left: 5px solid var(--accent); align-self: flex-start; }
    .bubble-user {
      background: #e1f5fe;
      border-right: 5px solid var(--info);
      margin-left: auto;
    }

    textarea {
      width: 100%;
      padding: 15px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 1rem;
      resize: none;
      margin-bottom: 15px;
      outline: none;
      font-family: inherit;
    }
    textarea:focus { border-color: #aac7ff; box-shadow: 0 0 0 4px rgba(0, 85, 170, 0.10); }

    .btn-primary {
      background: var(--primary);
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }
    .btn-primary:hover { background: #0055aa; }

    .suggestion-box {
      background: #fff3cd;
      border: 1px solid #ffeeba;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      display: none;
    }

    .hint {
      font-size: 0.85rem;
      margin-top: 10px;
      color: #444;
      opacity: 0.9;
    }

    .warn {
      color: var(--warn);
      font-weight: 700;
    }
  </style>
</head>

<body>
  <div class="sidebar">
    <h2>üìö Orientador Digital</h2>

    <div class="menu-item active" data-step="tema">1. Escolha do Tema</div>
    <div class="menu-item" data-step="problema">2. Problema de Pesquisa</div>
    <div class="menu-item" data-step="objetivo">3. Objetivos</div>
    <div class="menu-item" data-step="justificativa">4. Justificativa</div>

    <div style="margin-top: auto; padding-top: 20px; font-size: 0.8rem; text-align: center; opacity: 0.7;">
      Projeto Licenciatura Computa√ß√£o
    </div>
  </div>

  <div class="main-content">
    <header>
      <div>
        <h1 id="step-title">Fase 1: Tema</h1>
        <p id="step-desc">Defini√ß√£o do objeto de estudo</p>
      </div>

      <div class="thermometer-container">
        <span class="label-progress">Progresso do TCC: <strong id="perc">25%</strong></span>
        <div class="progress-bg">
          <div id="bar" class="progress-fill" style="width: 25%;"></div>
        </div>
      </div>
    </header>

    <div class="chat-area">
      <div class="bubble bubble-ai">
        <strong>üí° Dica do Orientador:</strong>
        <p id="ai-advice">Seja espec√≠fico! Um tema bem delimitado √© meio caminho andado para o sucesso do TCC.</p>
      </div>

      <div class="bubble bubble-user">
        <textarea id="user-input" rows="4" placeholder="Digite sua ideia aqui..."></textarea>
        <button class="btn-primary" id="btn-process">Formalizar e Validar</button>

        <div id="suggestion" class="suggestion-box" aria-live="polite">
          <strong>‚ú® Sugest√£o Acad√™mica:</strong>
          <p id="suggestion-text"></p>
          <div class="hint" id="hint"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== Config ======
    const STORAGE_KEY = "orientador_tcc_dashboard_step_v1";

    const steps = {
      tema: {
        title: "Fase 1: Tema",
        desc: "Defini√ß√£o do objeto de estudo",
        advice: "Seja espec√≠fico! Em vez de 'Tecnologia na Educa√ß√£o', tente 'O uso do Scratch no Ensino Fundamental I'.",
        perc: 25
      },
      problema: {
        title: "Fase 2: Problema",
        desc: "Qual a sua pergunta de pesquisa?",
        advice: "Transforme sua d√∫vida em pergunta. Comece com 'De que maneira...' ou 'Como...'.",
        perc: 50
      },
      objetivo: {
        title: "Fase 3: Objetivos",
        desc: "O que voc√™ far√° para responder ao problema?",
        advice: "Regra de ouro: comece com verbo no infinitivo (Analisar, Identificar, Desenvolver...).",
        perc: 75
      },
      justificativa: {
        title: "Fase 4: Justificativa",
        desc: "Por que este trabalho √© importante?",
        advice: "Mostre relev√¢ncia social, acad√™mica e profissional. Evite generaliza√ß√µes sem evid√™ncias.",
        perc: 100
      }
    };

    // ====== DOM ======
    const menuItems = Array.from(document.querySelectorAll(".menu-item"));
    const stepTitleEl = document.getElementById("step-title");
    const stepDescEl = document.getElementById("step-desc");
    const aiAdviceEl = document.getElementById("ai-advice");
    const percEl = document.getElementById("perc");
    const barEl = document.getElementById("bar");
    const inputEl = document.getElementById("user-input");
    const suggestionBoxEl = document.getElementById("suggestion");
    const suggestionTextEl = document.getElementById("suggestion-text");
    const hintEl = document.getElementById("hint");
    const btnProcess = document.getElementById("btn-process");

    // ====== Helpers ======
    function setActiveMenu(stepKey){
      menuItems.forEach(el => {
        const isActive = el.dataset.step === stepKey;
        el.classList.toggle("active", isActive);
      });
    }

    function setProgress(percent){
      const p = Math.max(0, Math.min(100, Number(percent) || 0));
      barEl.style.width = p + "%";
      percEl.innerText = p + "%";
    }

    function currentStepKey(){
      const active = document.querySelector(".menu-item.active");
      return active ? active.dataset.step : "tema";
    }

    function normalize(s){
      return (s || "")
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // remove acentos
        .trim();
    }

    function firstWord(text){
      // pega a primeira ‚Äúpalavra‚Äù real (ignora espa√ßos e pontua√ß√£o inicial)
      const m = (text || "").trim().match(/^[^\p{L}]*(\p{L}+)/u);
      return m ? m[1] : "";
    }

    // ====== Core ======
    function changeStep(stepKey, { persist=true } = {}){
      const cfg = steps[stepKey];
      if(!cfg) return;

      setActiveMenu(stepKey);
      stepTitleEl.innerText = cfg.title;
      stepDescEl.innerText = cfg.desc;
      aiAdviceEl.innerText = cfg.advice;
      setProgress(cfg.perc);

      inputEl.value = "";
      suggestionBoxEl.style.display = "none";
      suggestionTextEl.innerText = "";
      hintEl.innerText = "";

      inputEl.focus();

      if(persist){
        try { localStorage.setItem(STORAGE_KEY, stepKey); } catch {}
      }
    }

    function academicTransform(text){
      let out = text;

      // substitui√ß√µes com limites de palavra (menos agressivo)
      out = out.replace(/\beu acho que\b/gi, "Depreende-se que");
      out = out.replace(/\bmuito bom\b/gi, "significativo");
      out = out.replace(/\bajuda\b/gi, "contribui para");

      return out;
    }

    function validateObjectiveVerb(text){
      // valida que come√ßa com verbo no infinitivo (lista m√≠nima MVP)
      const verbs = ["analisar","identificar","desenvolver","verificar","compreender","propor","avaliar","investigar","examinar","descrever"];
      const fw = normalize(firstWord(text)).toLowerCase();

      if(!fw) return { ok:false, msg:"Digite um objetivo para validar." };

      // aceita se a primeira palavra for um dos verbos previstos
      if(verbs.includes(fw)) return { ok:true };

      return {
        ok:false,
        msg: `Seu objetivo deve come√ßar com um verbo no infinitivo. Ex.: ‚ÄúAnalisar ...‚Äù, ‚ÄúIdentificar ...‚Äù, ‚ÄúDesenvolver ...‚Äù.`
      };
    }

    function processText(){
      const raw = inputEl.value || "";
      const text = raw.trim();

      if(!text){
        suggestionBoxEl.style.display = "block";
        suggestionTextEl.innerHTML = `<span class="warn">‚ö†Ô∏è</span> Escreva sua ideia antes de formalizar.`;
        hintEl.innerText = "";
        inputEl.focus();
        return;
      }

      const stepKey = currentStepKey();
      let output = text;
      let hint = "";

      // Regra especial: objetivos precisam iniciar com verbo
      if(stepKey === "objetivo"){
        const v = validateObjectiveVerb(text);
        if(!v.ok){
          // sugere uma reescrita simples preservando o conte√∫do
          output = `‚ö†Ô∏è ${v.msg}\nSugest√£o: ‚ÄúAnalisar ${text.charAt(0).toLowerCase() + text.slice(1)}‚Äù`;
          hint = "Motivo: objetivos acad√™micos s√£o expressos como a√ß√£o (verbo no infinitivo) + objeto + contexto.";
        }
      }

      // Tradu√ß√£o acad√™mica simples
      output = academicTransform(output);

      suggestionBoxEl.style.display = "block";
      suggestionTextEl.innerText = output;
      hintEl.innerText = hint || "Dica: revise para manter coer√™ncia com seu tema e sua pergunta de pesquisa.";
    }

    // ====== Events ======
    menuItems.forEach(el => {
      el.addEventListener("click", () => changeStep(el.dataset.step));
    });

    btnProcess.addEventListener("click", processText);

    // Enter para processar (Ctrl+Enter), sem quebrar a digita√ß√£o normal
    inputEl.addEventListener("keydown", (e) => {
      if(e.key === "Enter" && (e.ctrlKey || e.metaKey)){
        e.preventDefault();
        processText();
      }
    });

    // ====== Boot ======
    (function init(){
      // restaura √∫ltima etapa se existir
      let saved = "tema";
      try { saved = localStorage.getItem(STORAGE_KEY) || "tema"; } catch {}
      if(!steps[saved]) saved = "tema";
      changeStep(saved, { persist:false });
    })();
  </script>
</body>
</html>
